<!DOCTYPE html>
<html>
<head>
    <title>Login</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>
<body class="bg-dark text-white d-flex align-items-center justify-content-center vh-100">

<div class="card p-4 bg-secondary shadow-lg" style="width: 350px;">
    <h3 class="text-center mb-3">Login</h3>
    <input type="text" id="username" class="form-control mb-2" placeholder="Username">
    <input type="password" id="password" class="form-control mb-3" placeholder="Password">
    <button class="btn btn-primary w-100" onclick="loginUser()">Login</button>
    <p class="mt-3 text-center">
        New user? <a href="/accounts/register/" class="text-light">Register</a>
    </p>
</div>

<script>
function loginUser() {
    fetch('/accounts/api/login/', {
        method: 'POST',
        headers: {'Content-Type': 'application/json'},
        body: JSON.stringify({
            username: document.getElementById('username').value,
            password: document.getElementById('password').value
        })
    })
    .then(res => res.json())
    .then(data => {
        if (data.access) {
            localStorage.setItem('access', data.access);
            localStorage.setItem('refresh', data.refresh);
            alert('Login successful!');
            window.location.href = '/main/';
        } else {
            alert(data.error || 'Invalid credentials');
        }
    })
    .catch(err => alert('Server error: ' + err));
}
</script>

</body>
</html>
